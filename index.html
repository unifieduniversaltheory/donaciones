<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test conexión Web3</title>
</head>
<body>
  <h1>Test conexión Web3</h1>
  <p>Si MetaMask se abre al hacer clic en el botón, el sitio ya es Web3.</p>

  <button id="connectButton">Conectar Wallet</button>

  <p>Dirección conectada: <span id="account">—</span></p>

  <script>
    const connectButton = document.getElementById('connectButton');
    const accountSpan = document.getElementById('account');

    async function connectWallet() {
      // 1. Verificar que MetaMask / provider exista
      if (typeof window.ethereum === 'undefined') {
        alert('MetaMask no está instalado o el navegador no lo detecta.');
        return;
      }

      try {
        // 2. Pedir conexión a la wallet
        const accounts = await window.ethereum.request({
          method: 'eth_requestAccounts'
        });

        // 3. Mostrar la primera cuenta conectada
        const account = accounts[0];
        accountSpan.textContent = account;
      } catch (error) {
        if (error.code === 4001) {
          // Usuario rechazó la conexión
          alert('Has rechazado la conexión en MetaMask.');
        } else {
          console.error(error);
          alert('Ocurrió un error al conectar con MetaMask. Revisa la consola.');
        }
      }
    }

    // Asignar el evento al botón
    connectButton.addEventListener('click', connectWallet);
  </script>
</body>
</html>
